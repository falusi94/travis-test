language: ruby
rvm:
- 2.3.3
services:
- postgresql
before_install:
- gem install bundler -v 1.16.0
- sudo apt -qq update
- sudo apt install -y sshpass
after_success:
- export RAILS_ENV=production && rake assets:precompile && export RAILS_SERVE_STATIC_FILES=1
- mkdir build
- mv * build
- tar -czf package.tgz build
- export SSHPASS=$DEPLOY_PASS
- sshpass -e scp -o StrictHostKeyChecking=no -P $DEPLOY_PORT package.tgz $DEPLOY_USER@$DEPLOY_HOST:$DEPLOY_PATH
- sshpass -e ssh -o StrictHostKeyChecking=no -p $DEPLOY_PORT $DEPLOY_USER@$DEPLOY_HOST $DEPLOY_PATH/deploy.sh
env:
  global:
  - secure: II17/igegShhxHOQmaUzVJT4wpLLA+q49WW0IM3RclcVdpoAT8f5urzyHsgzyGSlJYdMHbKASfY7bSaQGnp5QporBgvmQJrJN71T5JcHBkWEQYFag+gOhTldenmqrLgKI8YEaBTKGoPevW6e5wS10l5z4Txsi0Gucew96lBRw9xZaaa9W08EWShi1ZcG3/xgr6OsV0Eg6ZKIPIy/otC6sBeiffQ0hHzDYKkYMXp2b5j1uE8l/IclkU1wdNpfYAd5F2CaMoep/hPSBKQLHY3jsG/qb8euww+ofcu1Ll4UNKKRvUKcNjRZ3nMshihYpTevM6qWvyimiG9A6fXF6v+2j5ePqVtUvpUMA8tpbQFwqnxlHOVmpOC5+AiK3DJSbFfqO6bnYHuoAKLFN6SPCQ4Wo0X2CTECy4u2PNtnlJLMlwbV58vW0nBgvAjpHa+DuOtvubEe4qkmClMMsW6u6raVkYNDal98c+kjLHoc2F+QSm3l8t9sOaWZ8eka2wJl0Z/5hD54k9zJDqMWDlTxy4S7XXMnwlSRutG07iK/FKc7mQlB7lu5oyaC8SZcJH/2ozdxV214CRQYv3/yBmF0uKTRP2aAF+1Qs+fygpfy0GgvSmhtLXb1Bb4zfnzDHXDx79kmROMPirwRPdAk5lrVlaz/ngtFeW+OYsk2Uj46rQ7z7qw=
  - secure: otHE0e1H4kRXfmxKOW0pV1D9UVG27BCh/e5Ivx8ARmJ+21y5QhMQYVBho/8oSXhWoj/IkyMvyLpC6c43sEnTHZzKlqqdPVPNLeoYqzV5l1Eo9F7exJ1uAYNq74JPnFuaEf57ers0/C5ovyotyWTNYEtbKzQ02f5+Iakiw5MguFnA682k4wJ8LJ7duB6h8DSxCNPtgqrGevj/leIrkk1w5QqH1BdzhYqnpYPQXc7iWqhFX0A5Fq+niNQaYKRICIY+A2uqW59GFgXNDbKgwq1Oc6ykboBWy55G6qVI3UtpuR8ZD75Irg1Ejzr50Xma508ZVg6E2quU6Pms/XrAnyw610DNWk7ei/7OEl8kN+1A8XoI1oLEj3hLFEUZ6+7JhWPajxhJ16lWB39lo/iRtP2IKIGC1A9MY7TTppXZYekSdlweCpqf8ovFmriSE9zvt+CR7NJEFgSmiPkSI8FX/jSRraDWghPo12cyVvyF7jFn+h58kZw1677Di/gVZlrwYny5B1UkLreT0ur3PXqryb/uPJcMvfmzhMcmFsMpGIrhQfyB3mSM91oJFvgpOUl8wLb69zqvfU9Hvvy+aQkskaARc2XjJ7Rt/ruGbZtFsffjHaYaZio8hUomdUbIuYIULj5hsprpgJl6Q6yw3QkIZAaNOs8jNX87qYpHUO5b9aUoOuA=
  - secure: TdgyXzZohL4aGwYjyws75xnknUKE3MSyr8i2/wD4CqYFwgEZa5H3v4+QzbMn4gcb/QRX7IyFsLmjyT75QVxw+QfdvxBcflq1OPzRMf5AM3ouNywIzWmpNDibS9DG6DFx7FczZySdqT6r7gKUYmR4FSOvbbNRAI0zysj6TfcoC134xBgG00179MOxmvtenr58KU38ZxOx3Rv4gyG03zDqTpCYDm3h8FjiapGxewFNGYfsImBv5bGsCw9rt89upreePgVq+pTOhOMPb3LWSf0evVpK59au+4ePUp+iSJrqdEivcbyc5VpeBgEBrSN0dOiWkiEtbkQzgJXArTGKJxzCVzQwHnMtXdkplYSNcA2l2lWr1duCSCuOBtJozuqvW8dv0J7lxCBf95BR+MSCtBBOBI6RuE0fiYEG1/z0nb4uXvrjt3dstsHMymFtd/El8eCytZR8DRzXudwJIZxCaLjpG4OxYN3+TZuCN7tNOjCmaaWvK5oAePrtwhIeUMmzL7q+IO6hYOcUfCJ05jvlZefEZzXwzMDs6fy9TsPDCUB07UHyPVO7Yg21S3/wYNUboGf0fv/RgDuYx7KtOjQfdPRedI8U5EbslFo/BX2DEpU8C1TR5zNXYNxboiLx/2kjcQR+SFB9FI9xdNQukkhBWLmN5BdRqcHiIYHgIHdPkvRRfN4=
  - secure: U8CD9LforTLZ/umpCdg2ZpguPSn1Hdfqf6iLZNAecqPc/GCWoLCG7EoK0HYotHn4E+NHUpqFf0y0ujDqjfUIGQiCIb926LanpVwvux/0o0cPcPCz/MuvKISNgBpXsVPyZZoWx8E6G7zIatIxI+H0EqYfvLwgwTZsR4FtmMbhDwOUfo8GXewqlzEBbh7KvikV/Li5rIdVPmounGa07cUN8/I6VRj5zRsp8laKqxAyPPOosKbSJGMzC0JkKlnrdTVxW2+JoOREAdIyGtInRA6bQF/NuiE+Si/Fq8EHzV4uQK6hYTHpYaMUWyiYR7Z9BryEqTHX2NjqJk8OOKShNvRdHZZq9C8n8s4u+H0r/8SGV1+rv7sYWJMEw9LVCKvNjL7QFq7fEvYO6bi+ghAZ9zZv9q0t/roEwzNf3ofB1Zenwz9CkNIElOsQcz732Cvt4BDYl4apPx7z95fQyegNQ+T3Vpbt38dVjSQgjLIYp1YsDheJkUrSEiRfaMHrinwxPgxX/SJsUVlDtBrFHdsI0Kt4tnIrayXRNLhZZFyuEwrYvPxYyEzMjDo/O5K4dyk5db+PMuy9XsHwivfRNOwKlNQEmXMHgLsjBgV4Z39EYZOo6FuYZr0FExEbjuYravTOMPKeFcmcf0pNCMuYfduruWPz4DWRyIwKnCEmUivwYLp/13g=
  - secure: RZSImFvh9i68LOXVsztxwmE2Cxabg8MG1V5Zbcsc9IeOQXOvt/yyRDjWpOMXVVjhto0eCK8NjmiB7mzXvo+68qQmJ4/XhCl1DL+N2k+ZvXJXYDPNvmSyFOrfqQyPSWJ91OupjrbUcx5ch2efHhO6iwAcMREFmRXEKNv59nNpSrCDQ9wVMWXl5g+2WHEUNTt9fURPHSrPdeo5fVZ7jjx67rJFfIcuDjQxgPvQd0OVc/WM+R4YR/ouar3YkYNP4PIGlzXA61AYVNdx7PtCdERkdlKihXPasTmOJdqjWtjldSFJP63sRzUcZbdNh0onLx32+odFpfRvihUWrkay9JtGGarpqNQiKyHOuvlc8QHao4nICNE9aqxRqm7FTz6/xBXoqv9/0ALJdYnm6RkwsEr9brzvu13qlhSb7hKylPgNtaixqNy5F9FQ927Rh2SnjsvnoaQguePOmbEQo2QkkaAtLDyNliT63ol6yBqRk3kh+hBUv7YzZ0TeC4l3EchzmRlAGe0Ubp6qmNO7dRlD4OU/FV7TV84cSEf+9ZKHBccL8zb0YgDbZyGZxyjb16ACJPz+9cv3n/bbxQE1NeJQDjjefj8A9trYRlnYETTWjgtoyLnAGBI55dk1ErWb+OvYCzF7rC8aIRP4/irh7eRNzsilmgH6YnUkwSsmdeVfsZ/Uz6M=
