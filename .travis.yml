language: ruby
rvm:
- 2.3.3
services:
- postgresql
before_install:
- gem install bundler -v 1.16.0
- sudo apt -qq update
- sudo apt install -y sshpass
after_success:
- export RAILS_ENV=production && rake assets:precompile && export RAILS_SERVE_STATIC_FILES=1
- mkdir build
- mv * build
- tar -czf package.tgz build
- export SSHPASS=$DEPLOY_PASS
- sshpass -e scp -P $DEPLOY_PORT package.tgz $DEPLOY_USER@$DEPLOY_HOST:$DEPLOY_PATH
- sshpass -e ssh -o StrictHostKeyChecking=no $DEPLOY_USER@$DEPLOY_HOST -p $DEPLOY_PORT $DEPLOY_PATH/deploy.sh
env:
  global:
  - secure: emQ7s5kowY0/Uz198/46TgPd5I85YWmzJeAOfAR/GKiOItE+CnsKEFl1KVshn3tAk5YjBttAmF2GehfN8guWvEL7krs7Db7Yq13rA62OqFAaD4H6vwTJAW1sbf53FegToIYk8ni3rk2qk4dRvz6+Xa7T9bQYZzytizmD+5r1CzR4c2h2RYbfS9r30oHyjN+2qXDIiNBF8xHdaazXrYaMF/AP3TZoQRGSVCxZwvzqr1Ka5CjUFyhY5HVB0tjrclZ5DTEGbMZmPZjPT5kmLjy4YvCKo4tYd8dNxbXmlMhigyX/BNxbBXJ0fLXc390CfTgyUcV3Aru2OSZBpSWE18qkB0ndZVTIsdJQr1B2W8d+nSNaZhJKsOdPVJnJS0msl5eqTdBtWetffyIhm5ac5xWbhL6oFuCaEca1VLUwbGa0sl4yicE7ajhIQ+7l3buPqToNhvz27C4zncJkSuhvVU263P2gMt1DmrsDL4mKZOe3Gj2XboW/A0DRNVoIfKr+91Aud6Bg+wYdZkTFgbMsbBQhgvb2tZ++nI25SwI5MVDXtbtESi/oaxVsJWPUuCB50WcSeEtImrZvpZouSd+Y3mvm5+7x2nmmtvlgrUEXhYc22dszfe6rZcySGuj6SoQN8nr/GqkrmARFuG8OAQA2n/QqoSfTg0Pko9ojjzGP3UMhXAE=
  - secure: Z2GJcqZ8QxB73+qqI/IODYd1yD6wAbvb8mukitvDmQHaRL62uDIokIDNN3JNHYnG8ZEAP6XyqV/bIoIuPO4rIFdYoB2eVWerswVk3TKGsd+N1kr+5y3KpYsk7XbkNmqbpKdoHPh+PUDP0U1wLSqmujaCz9LWGHuG0+5fIbV4vfNBpA+9AL7i3VnUwI+dwS9cTgf0VCu1YFshodIA/PVtGkbfGOiMYOKbGxnYhXB6tOnv/46vg0yekpil8xFVhTSTjsEkB4jiS84ek4YSucZT4JBLsrVHtPdc6PL8//V4WILQcSjuWgOY8HeUYIUjtdB2sZjSn4nWGAoRxcGAFJE1GPMnAnecEKm1n1XfPPtd7B7SOp6sT/RbHd2HXc2UE3A+zxGTdBmCrhBHPPc1nxTILXJNGhOb/olUZ7rIoTVi8lgRKGv0k62aRAE5lypEsJGW7SPpgY+1muM1yoDCGf+M7zhqFaIczYH/1nz/YTAfsNNVxjHpjPW8bzT0Ws3d2HYEjCyP3egBHnDpWIHrm2TmTZEhVO8DMT0eHNwz9uW2STOoXLsnA1bYTv/d8n16oyU0mVW/ff24ADEiN3wIdKLj9Vg7RBzFmWW6bQO3qg2HT7DVRbcPyI4XCsO0UhIxAJV5PRo3OgPA/HkyAQn3cMAiFcPd8Vj464miS5vu7rFp6u0=
  - secure: LoQosXTkQ9GkLYlxylcwvw/kCad525Ek6g1SGPBqUhf/LEgu10fqiukag4rKsphYze5OcH1Fb+tONmNL8fXTHbsCHhNqGG83JghxPqLVxvTcNLcFBDvnSCmgjuM40G9YF8ZapKQyV54FJLwsYM7cCJ6EMEj/HYTEEyzADwlm3LDKqYu2sVM8F5EZQ697ZfH+PcMYQ9fPVAvn30kWmipYmMpFjXcUENZ5jXYHVK0p+J+KRvTbhATynptXqWgAHNarWqzScaCwPAq7yMO92KihEE/22S7rlFgIQPp2rgVJmxh0hBclKC/bfptcfLMB/+yC8H3LaUI70OQZoRiH+1jsVLgS7tdsFbBS2p7FN/nWSKke3hrPDgOpkfDm2AixzLhehnxaIXqNOfvN9isBaSnRvvqjCbjcZ4R4SOcWMgqIhQZkX6r0esIx5he5LJ/4rP89iyFmvgU526pCBxi8ke51ZnAo00wsD96A/jb0eYMT2JN0E8omFiea289Z76wTBsr6WKazFqh84x0zNp0ASB/dOnJb2kCNA4Tbq5y0A76N3z1TSXf1kGV+smb0hZjtgjfGbBzYNL70uiDNCses5MpyxAIspWfUt7vYtxzETePBni2pKPbohGmW/20h85qFRWYDgkNcCpyTqtlNSnbG36nQxkxBMymrlCTSx+h+g4niewA=
  - secure: Bq7Bp4AVLRntlhS7NzavNwCU0RNuwubBECOvA5SKBy/hFf9rEetbMYfaAQcC2MyRPsWd7z/1pMFBbjLKwUW2ksG1lFZl5lMfumaUG9nBHUtDznf9W2HPgcYLn+hwMsTRi/xZzTD/f/+FTgM7b+SXinQ/9s6/63JxRQLNnz9aOWH8gJ4b98SB9pS4xj/9W2BK3NEFiwt7Ao9G1pwejHtyeyJ0o/fV0FRmurs7dBlgw5MwGGN4173ri7jT6WBvqnPFZ7NUWlEpcoZtE2Flhu8b2bKo3Cjv3kF8IR85gpJHlSJopCP4zEaqY/vVaDjCwbc0zY59zHUcqK08VC8/tf2J176IFJ2takCTNDwIeB7273DlmsoDWwmKQkvcPMrCJNHj834UxirAnxSIPJeCwf+Df7L6uLhtxNMBKgaRRH7dcvsKHN6hizBuxAv6/2Eu1dL+cfMgrpXPHcfLeq2yadqzcutGFHYuqFf7eCw6aPWnmrjq7wgtPLrOF8Fq6myC4VzMz3r6/ULOBkjPMgvFXdNZrALkn2fHnZZJcudqxgcG3hAc6hLRSsB46O7LkNWFWGNIgHXhj9uR3b4YqDt5lriUXVAlRoZ2pdbagBQOdZ2FdxqwtIPPXFjVggJsGciXBrHLr+/GaKSlb/kBl+pIkf+umsRCLrp2KBw0a2uHcxpejBk=
  - secure: mVM/JhmeOGkYyzA/0URineXFU7Trodt2LiWLvKCzHlZIBPWOsjDko71EdZxJXtjW7TP/zSXysFepebaELAOSj4EqLHvQJyi1DyKC2a4Hc8hJ/u5OfMSXDRTLZ/fRCfg2WZY78FNQD7zeMWLHFWt4jKLpE4ouImDf49YAZXLhyTuTKgcSsUS+PqTZ87YaqWn5XnLW9ckZjhnYECG8+zTPQpUjYl8Mq8EHCmymOBdwtqZPfm5w0WXKqPstZppW/JJFgO8jznqhpZCgUDrwDOSSBXdfRVoLmKAhMb5AncDOmu2eIR6GPdAb9YecB8+GjNduWecgl62VbUJ6OMsVmyxe/JSYR+fsPzx6+Ke3LLZphWfP82LkFFi2XEKr3s5v0K7BR240aoTB7UU0Xjg8SlVPv2bbYqVBGv0PB9qEq1Yn+tsEabaSFbzt7aepngoqDckSsefbZZGkCjE8TFc4hqQZP8wD88hGWysOSOPnwYnjrD0suw1plzQdgd/wvqVmR2ePJfV+8thOyjZBWzkejbaTPL9fqjSB/K0qiRcj/H4PpnjIJ6OxSqP8h+uhAJlEmPEDbERnt0vSwEydGAkVSMfwQ7UsCGAVQW5uH+LVei8BNEWUhVBddoyh7ZKskC7zCVYUzj7LxTGCuaWL49uCxqmkAeXE+tfYSqBnJHuj9whM0qM=
